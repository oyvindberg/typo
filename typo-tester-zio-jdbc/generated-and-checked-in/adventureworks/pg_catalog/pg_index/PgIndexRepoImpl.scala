/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks
package pg_catalog
package pg_index

import java.lang.Throwable
import typo.dsl.DeleteBuilder
import typo.dsl.SelectBuilder
import typo.dsl.SelectBuilderSql
import typo.dsl.UpdateBuilder
import zio.ZIO
import zio.jdbc.SqlInterpolator
import zio.jdbc.ZConnection
import zio.stream.ZStream

object PgIndexRepoImpl extends PgIndexRepo {
  override def delete(indexrelid: PgIndexId): ZIO[ZConnection, Throwable, Boolean] = {
    sql"""delete from pg_catalog.pg_index where "indexrelid" = ???""".update.map(_ > 0)
  }
  override def delete: DeleteBuilder[PgIndexFields, PgIndexRow] = {
    DeleteBuilder("pg_catalog.pg_index", PgIndexFields)
  }
  override def insert(unsaved: PgIndexRow): ZIO[ZConnection, Throwable, PgIndexRow] = {
    sql"""insert into pg_catalog.pg_index("indexrelid", "indrelid", "indnatts", "indnkeyatts", "indisunique", "indisprimary", "indisexclusion", "indimmediate", "indisclustered", "indisvalid", "indcheckxmin", "indisready", "indislive", "indisreplident", "indkey", "indcollation", "indclass", "indoption", "indexprs", "indpred")
          values (???::oid, ???::oid, ???::int2, ???::int2, ???, ???, ???, ???, ???, ???, ???, ???, ???, ???, ???::int2vector, ???::oidvector, ???::oidvector, ???::int2vector, ???::pg_node_tree, ???::pg_node_tree)
          returning "indexrelid", "indrelid", "indnatts", "indnkeyatts", "indisunique", "indisprimary", "indisexclusion", "indimmediate", "indisclustered", "indisvalid", "indcheckxmin", "indisready", "indislive", "indisreplident", "indkey", "indcollation", "indclass", "indoption", "indexprs", "indpred"
       """.query(???).update.map(_ > 0)
  }
  override def select: SelectBuilder[PgIndexFields, PgIndexRow] = {
    SelectBuilderSql("pg_catalog.pg_index", PgIndexFields, PgIndexRow.read)
  }
  override def selectAll: ZStream[ZConnection, Throwable, PgIndexRow] = {
    sql"""select "indexrelid", "indrelid", "indnatts", "indnkeyatts", "indisunique", "indisprimary", "indisexclusion", "indimmediate", "indisclustered", "indisvalid", "indcheckxmin", "indisready", "indislive", "indisreplident", "indkey", "indcollation", "indclass", "indoption", "indexprs", "indpred" from pg_catalog.pg_index""".query[PgIndexRow].selectStream
  }
  override def selectById(indexrelid: PgIndexId): ZIO[ZConnection, Throwable, Option[PgIndexRow]] = {
    sql"""select "indexrelid", "indrelid", "indnatts", "indnkeyatts", "indisunique", "indisprimary", "indisexclusion", "indimmediate", "indisclustered", "indisvalid", "indcheckxmin", "indisready", "indislive", "indisreplident", "indkey", "indcollation", "indclass", "indoption", "indexprs", "indpred" from pg_catalog.pg_index where "indexrelid" = ???""".query[PgIndexRow].selectOne
  }
  override def selectByIds(indexrelids: Array[PgIndexId]): ZStream[ZConnection, Throwable, PgIndexRow] = {
    sql"""select "indexrelid", "indrelid", "indnatts", "indnkeyatts", "indisunique", "indisprimary", "indisexclusion", "indimmediate", "indisclustered", "indisvalid", "indcheckxmin", "indisready", "indislive", "indisreplident", "indkey", "indcollation", "indclass", "indoption", "indexprs", "indpred" from pg_catalog.pg_index where "indexrelid" = ANY(${indexrelids})""".query[PgIndexRow].selectStream
  }
  override def update(row: PgIndexRow): ZIO[ZConnection, Throwable, Boolean] = {
    val indexrelid = row.indexrelid
    sql"""update pg_catalog.pg_index
          set "indrelid" = ???::oid,
              "indnatts" = ???::int2,
              "indnkeyatts" = ???::int2,
              "indisunique" = ???,
              "indisprimary" = ???,
              "indisexclusion" = ???,
              "indimmediate" = ???,
              "indisclustered" = ???,
              "indisvalid" = ???,
              "indcheckxmin" = ???,
              "indisready" = ???,
              "indislive" = ???,
              "indisreplident" = ???,
              "indkey" = ???::int2vector,
              "indcollation" = ???::oidvector,
              "indclass" = ???::oidvector,
              "indoption" = ???::int2vector,
              "indexprs" = ???::pg_node_tree,
              "indpred" = ???::pg_node_tree
          where "indexrelid" = ???""".update.map(_ > 0)
  }
  override def update: UpdateBuilder[PgIndexFields, PgIndexRow] = {
    UpdateBuilder("pg_catalog.pg_index", PgIndexFields, PgIndexRow.read)
  }
  override def upsert(unsaved: PgIndexRow): ZIO[ZConnection, Throwable, PgIndexRow] = {
    sql"""insert into pg_catalog.pg_index("indexrelid", "indrelid", "indnatts", "indnkeyatts", "indisunique", "indisprimary", "indisexclusion", "indimmediate", "indisclustered", "indisvalid", "indcheckxmin", "indisready", "indislive", "indisreplident", "indkey", "indcollation", "indclass", "indoption", "indexprs", "indpred")
          values (
            ???::oid,
            ???::oid,
            ???::int2,
            ???::int2,
            ???,
            ???,
            ???,
            ???,
            ???,
            ???,
            ???,
            ???,
            ???,
            ???,
            ???::int2vector,
            ???::oidvector,
            ???::oidvector,
            ???::int2vector,
            ???::pg_node_tree,
            ???::pg_node_tree
          )
          on conflict ("indexrelid")
          do update set
            "indrelid" = EXCLUDED."indrelid",
            "indnatts" = EXCLUDED."indnatts",
            "indnkeyatts" = EXCLUDED."indnkeyatts",
            "indisunique" = EXCLUDED."indisunique",
            "indisprimary" = EXCLUDED."indisprimary",
            "indisexclusion" = EXCLUDED."indisexclusion",
            "indimmediate" = EXCLUDED."indimmediate",
            "indisclustered" = EXCLUDED."indisclustered",
            "indisvalid" = EXCLUDED."indisvalid",
            "indcheckxmin" = EXCLUDED."indcheckxmin",
            "indisready" = EXCLUDED."indisready",
            "indislive" = EXCLUDED."indislive",
            "indisreplident" = EXCLUDED."indisreplident",
            "indkey" = EXCLUDED."indkey",
            "indcollation" = EXCLUDED."indcollation",
            "indclass" = EXCLUDED."indclass",
            "indoption" = EXCLUDED."indoption",
            "indexprs" = EXCLUDED."indexprs",
            "indpred" = EXCLUDED."indpred"
          returning "indexrelid", "indrelid", "indnatts", "indnkeyatts", "indisunique", "indisprimary", "indisexclusion", "indimmediate", "indisclustered", "indisvalid", "indcheckxmin", "indisready", "indislive", "indisreplident", "indkey", "indcollation", "indclass", "indoption", "indexprs", "indpred"
       """.query(???).unique
  }
}
