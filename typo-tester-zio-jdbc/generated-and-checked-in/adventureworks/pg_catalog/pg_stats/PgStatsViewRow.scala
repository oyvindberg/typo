/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks
package pg_catalog
package pg_stats

import adventureworks.customtypes.TypoAnyArray
import java.sql.ResultSet
import zio.jdbc.JdbcDecoder
import zio.json.JsonDecoder
import zio.json.JsonEncoder
import zio.json.ast.Json
import zio.json.internal.Write

case class PgStatsViewRow(
  /** Points to [[pg_namespace.PgNamespaceRow.nspname]] */
  schemaname: Option[String],
  /** Points to [[pg_class.PgClassRow.relname]] */
  tablename: String,
  /** Points to [[pg_attribute.PgAttributeRow.attname]] */
  attname: String,
  /** Points to [[pg_statistic.PgStatisticRow.stainherit]] */
  inherited: Boolean,
  /** Points to [[pg_statistic.PgStatisticRow.stanullfrac]] */
  nullFrac: Float,
  /** Points to [[pg_statistic.PgStatisticRow.stawidth]] */
  avgWidth: Int,
  /** Points to [[pg_statistic.PgStatisticRow.stadistinct]] */
  nDistinct: Float,
  mostCommonVals: /* nullability unknown */ Option[TypoAnyArray],
  mostCommonFreqs: /* nullability unknown */ Option[Array[Float]],
  histogramBounds: /* nullability unknown */ Option[TypoAnyArray],
  correlation: /* nullability unknown */ Option[Float],
  mostCommonElems: /* nullability unknown */ Option[TypoAnyArray],
  mostCommonElemFreqs: /* nullability unknown */ Option[Array[Float]],
  elemCountHistogram: /* nullability unknown */ Option[Array[Float]]
)

object PgStatsViewRow {
  implicit lazy val jdbcDecoder: JdbcDecoder[PgStatsViewRow] = new JdbcDecoder[PgStatsViewRow] {
    override def unsafeDecode(columIndex: Int, rs: ResultSet): (Int, PgStatsViewRow) =
      columIndex + 13 ->
        PgStatsViewRow(
          schemaname = JdbcDecoder.optionDecoder(JdbcDecoder.stringDecoder).unsafeDecode(columIndex + 0, rs)._2,
          tablename = JdbcDecoder.stringDecoder.unsafeDecode(columIndex + 1, rs)._2,
          attname = JdbcDecoder.stringDecoder.unsafeDecode(columIndex + 2, rs)._2,
          inherited = JdbcDecoder.booleanDecoder.unsafeDecode(columIndex + 3, rs)._2,
          nullFrac = JdbcDecoder.floatDecoder.unsafeDecode(columIndex + 4, rs)._2,
          avgWidth = JdbcDecoder.intDecoder.unsafeDecode(columIndex + 5, rs)._2,
          nDistinct = JdbcDecoder.floatDecoder.unsafeDecode(columIndex + 6, rs)._2,
          mostCommonVals = JdbcDecoder.optionDecoder(TypoAnyArray.jdbcDecoder).unsafeDecode(columIndex + 7, rs)._2,
          mostCommonFreqs = JdbcDecoder.optionDecoder(adventureworks.FloatArrayDecoder).unsafeDecode(columIndex + 8, rs)._2,
          histogramBounds = JdbcDecoder.optionDecoder(TypoAnyArray.jdbcDecoder).unsafeDecode(columIndex + 9, rs)._2,
          correlation = JdbcDecoder.optionDecoder(JdbcDecoder.floatDecoder).unsafeDecode(columIndex + 10, rs)._2,
          mostCommonElems = JdbcDecoder.optionDecoder(TypoAnyArray.jdbcDecoder).unsafeDecode(columIndex + 11, rs)._2,
          mostCommonElemFreqs = JdbcDecoder.optionDecoder(adventureworks.FloatArrayDecoder).unsafeDecode(columIndex + 12, rs)._2,
          elemCountHistogram = JdbcDecoder.optionDecoder(adventureworks.FloatArrayDecoder).unsafeDecode(columIndex + 13, rs)._2
        )
  }
  implicit lazy val jsonDecoder: JsonDecoder[PgStatsViewRow] = JsonDecoder[Json.Obj].mapOrFail { jsonObj =>
    val schemaname = jsonObj.get("schemaname").fold[Either[String, Option[String]]](Right(None))(_.as(JsonDecoder.option(JsonDecoder.string)))
    val tablename = jsonObj.get("tablename").toRight("Missing field 'tablename'").flatMap(_.as(JsonDecoder.string))
    val attname = jsonObj.get("attname").toRight("Missing field 'attname'").flatMap(_.as(JsonDecoder.string))
    val inherited = jsonObj.get("inherited").toRight("Missing field 'inherited'").flatMap(_.as(JsonDecoder.boolean))
    val nullFrac = jsonObj.get("null_frac").toRight("Missing field 'null_frac'").flatMap(_.as(JsonDecoder.float))
    val avgWidth = jsonObj.get("avg_width").toRight("Missing field 'avg_width'").flatMap(_.as(JsonDecoder.int))
    val nDistinct = jsonObj.get("n_distinct").toRight("Missing field 'n_distinct'").flatMap(_.as(JsonDecoder.float))
    val mostCommonVals = jsonObj.get("most_common_vals").fold[Either[String, Option[TypoAnyArray]]](Right(None))(_.as(JsonDecoder.option(TypoAnyArray.jsonDecoder)))
    val mostCommonFreqs = jsonObj.get("most_common_freqs").fold[Either[String, Option[Array[Float]]]](Right(None))(_.as(JsonDecoder.option(JsonDecoder.array[Float](JsonDecoder.float, implicitly))))
    val histogramBounds = jsonObj.get("histogram_bounds").fold[Either[String, Option[TypoAnyArray]]](Right(None))(_.as(JsonDecoder.option(TypoAnyArray.jsonDecoder)))
    val correlation = jsonObj.get("correlation").fold[Either[String, Option[Float]]](Right(None))(_.as(JsonDecoder.option(JsonDecoder.float)))
    val mostCommonElems = jsonObj.get("most_common_elems").fold[Either[String, Option[TypoAnyArray]]](Right(None))(_.as(JsonDecoder.option(TypoAnyArray.jsonDecoder)))
    val mostCommonElemFreqs = jsonObj.get("most_common_elem_freqs").fold[Either[String, Option[Array[Float]]]](Right(None))(_.as(JsonDecoder.option(JsonDecoder.array[Float](JsonDecoder.float, implicitly))))
    val elemCountHistogram = jsonObj.get("elem_count_histogram").fold[Either[String, Option[Array[Float]]]](Right(None))(_.as(JsonDecoder.option(JsonDecoder.array[Float](JsonDecoder.float, implicitly))))
    if (schemaname.isRight && tablename.isRight && attname.isRight && inherited.isRight && nullFrac.isRight && avgWidth.isRight && nDistinct.isRight && mostCommonVals.isRight && mostCommonFreqs.isRight && histogramBounds.isRight && correlation.isRight && mostCommonElems.isRight && mostCommonElemFreqs.isRight && elemCountHistogram.isRight)
      Right(PgStatsViewRow(schemaname = schemaname.toOption.get, tablename = tablename.toOption.get, attname = attname.toOption.get, inherited = inherited.toOption.get, nullFrac = nullFrac.toOption.get, avgWidth = avgWidth.toOption.get, nDistinct = nDistinct.toOption.get, mostCommonVals = mostCommonVals.toOption.get, mostCommonFreqs = mostCommonFreqs.toOption.get, histogramBounds = histogramBounds.toOption.get, correlation = correlation.toOption.get, mostCommonElems = mostCommonElems.toOption.get, mostCommonElemFreqs = mostCommonElemFreqs.toOption.get, elemCountHistogram = elemCountHistogram.toOption.get))
    else Left(List[Either[String, Any]](schemaname, tablename, attname, inherited, nullFrac, avgWidth, nDistinct, mostCommonVals, mostCommonFreqs, histogramBounds, correlation, mostCommonElems, mostCommonElemFreqs, elemCountHistogram).flatMap(_.left.toOption).mkString(", "))
  }
  implicit lazy val jsonEncoder: JsonEncoder[PgStatsViewRow] = new JsonEncoder[PgStatsViewRow] {
    override def unsafeEncode(a: PgStatsViewRow, indent: Option[Int], out: Write): Unit = {
      out.write("{")
      out.write(""""schemaname":""")
      JsonEncoder.option(JsonEncoder.string).unsafeEncode(a.schemaname, indent, out)
      out.write(",")
      out.write(""""tablename":""")
      JsonEncoder.string.unsafeEncode(a.tablename, indent, out)
      out.write(",")
      out.write(""""attname":""")
      JsonEncoder.string.unsafeEncode(a.attname, indent, out)
      out.write(",")
      out.write(""""inherited":""")
      JsonEncoder.boolean.unsafeEncode(a.inherited, indent, out)
      out.write(",")
      out.write(""""null_frac":""")
      JsonEncoder.float.unsafeEncode(a.nullFrac, indent, out)
      out.write(",")
      out.write(""""avg_width":""")
      JsonEncoder.int.unsafeEncode(a.avgWidth, indent, out)
      out.write(",")
      out.write(""""n_distinct":""")
      JsonEncoder.float.unsafeEncode(a.nDistinct, indent, out)
      out.write(",")
      out.write(""""most_common_vals":""")
      JsonEncoder.option(TypoAnyArray.jsonEncoder).unsafeEncode(a.mostCommonVals, indent, out)
      out.write(",")
      out.write(""""most_common_freqs":""")
      JsonEncoder.option(JsonEncoder.array[Float](JsonEncoder.float, implicitly)).unsafeEncode(a.mostCommonFreqs, indent, out)
      out.write(",")
      out.write(""""histogram_bounds":""")
      JsonEncoder.option(TypoAnyArray.jsonEncoder).unsafeEncode(a.histogramBounds, indent, out)
      out.write(",")
      out.write(""""correlation":""")
      JsonEncoder.option(JsonEncoder.float).unsafeEncode(a.correlation, indent, out)
      out.write(",")
      out.write(""""most_common_elems":""")
      JsonEncoder.option(TypoAnyArray.jsonEncoder).unsafeEncode(a.mostCommonElems, indent, out)
      out.write(",")
      out.write(""""most_common_elem_freqs":""")
      JsonEncoder.option(JsonEncoder.array[Float](JsonEncoder.float, implicitly)).unsafeEncode(a.mostCommonElemFreqs, indent, out)
      out.write(",")
      out.write(""""elem_count_histogram":""")
      JsonEncoder.option(JsonEncoder.array[Float](JsonEncoder.float, implicitly)).unsafeEncode(a.elemCountHistogram, indent, out)
      out.write("}")
    }
  }
}
