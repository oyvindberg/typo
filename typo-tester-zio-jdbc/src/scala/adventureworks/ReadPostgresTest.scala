package adventureworks

import org.scalactic.TypeCheckedTripleEquals
import org.scalatest.funsuite.AnyFunSuite
import zio.{Chunk, ZIO}
import zio.stream.ZStream

class ReadPostgresTest extends AnyFunSuite with TypeCheckedTripleEquals {
  test("don't fail while reading rows from postgres tables") {
    withConnection(
      ZStream
        .fromChunk(
          Chunk(
            adventureworks.information_schema.administrable_role_authorizations.AdministrableRoleAuthorizationsViewRepoImpl.selectAll,
            adventureworks.information_schema._pg_foreign_servers.PgForeignServersViewRepoImpl.selectAll,
            adventureworks.information_schema.sql_features.SqlFeaturesRepoImpl.selectAll,
            adventureworks.information_schema.sql_parts.SqlPartsRepoImpl.selectAll,
            adventureworks.information_schema.tables.TablesViewRepoImpl.selectAll,
            adventureworks.information_schema.check_constraint_routine_usage.CheckConstraintRoutineUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.column_domain_usage.ColumnDomainUsageViewRepoImpl.selectAll,
            adventureworks.information_schema._pg_foreign_data_wrappers.PgForeignDataWrappersViewRepoImpl.selectAll,
            adventureworks.information_schema.domains.DomainsViewRepoImpl.selectAll,
            adventureworks.information_schema.key_column_usage.KeyColumnUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.view_column_usage.ViewColumnUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.foreign_servers.ForeignServersViewRepoImpl.selectAll,
            adventureworks.information_schema.column_column_usage.ColumnColumnUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.character_sets.CharacterSetsViewRepoImpl.selectAll,
            adventureworks.information_schema.routine_column_usage.RoutineColumnUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.column_options.ColumnOptionsViewRepoImpl.selectAll,
            adventureworks.information_schema.user_defined_types.UserDefinedTypesViewRepoImpl.selectAll,
            adventureworks.information_schema.element_types.ElementTypesViewRepoImpl.selectAll,
            adventureworks.information_schema.collation_character_set_applicability.CollationCharacterSetApplicabilityViewRepoImpl.selectAll,
            adventureworks.information_schema.triggers.TriggersViewRepoImpl.selectAll,
            adventureworks.information_schema.applicable_roles.ApplicableRolesViewRepoImpl.selectAll,
            adventureworks.information_schema.usage_privileges.UsagePrivilegesViewRepoImpl.selectAll,
            adventureworks.information_schema.table_privileges.TablePrivilegesViewRepoImpl.selectAll,
            adventureworks.information_schema.role_usage_grants.RoleUsageGrantsViewRepoImpl.selectAll,
            adventureworks.information_schema.role_table_grants.RoleTableGrantsViewRepoImpl.selectAll,
            adventureworks.information_schema.view_table_usage.ViewTableUsageViewRepoImpl.selectAll,
            adventureworks.information_schema._pg_foreign_tables.PgForeignTablesViewRepoImpl.selectAll,
            adventureworks.information_schema.routine_table_usage.RoutineTableUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.user_mapping_options.UserMappingOptionsViewRepoImpl.selectAll,
            adventureworks.information_schema.referential_constraints.ReferentialConstraintsViewRepoImpl.selectAll,
            adventureworks.information_schema.user_mappings.UserMappingsViewRepoImpl.selectAll,
            adventureworks.information_schema.routine_sequence_usage.RoutineSequenceUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.enabled_roles.EnabledRolesViewRepoImpl.selectAll,
            adventureworks.information_schema.table_constraints.TableConstraintsViewRepoImpl.selectAll,
            adventureworks.information_schema.view_routine_usage.ViewRoutineUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.attributes.AttributesViewRepoImpl.selectAll,
            adventureworks.information_schema.constraint_column_usage.ConstraintColumnUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.domain_constraints.DomainConstraintsViewRepoImpl.selectAll,
            adventureworks.information_schema.routines.RoutinesViewRepoImpl.selectAll,
            adventureworks.information_schema.triggered_update_columns.TriggeredUpdateColumnsViewRepoImpl.selectAll,
            adventureworks.information_schema.domain_udt_usage.DomainUdtUsageViewRepoImpl.selectAll,
            adventureworks.information_schema._pg_user_mappings.PgUserMappingsViewRepoImpl.selectAll,
            adventureworks.information_schema.transforms.TransformsViewRepoImpl.selectAll,
            adventureworks.information_schema.foreign_table_options.ForeignTableOptionsViewRepoImpl.selectAll,
            adventureworks.information_schema._pg_foreign_table_columns.PgForeignTableColumnsViewRepoImpl.selectAll,
            adventureworks.information_schema.information_schema_catalog_name.InformationSchemaCatalogNameViewRepoImpl.selectAll,
            adventureworks.information_schema.sequences.SequencesViewRepoImpl.selectAll,
            adventureworks.information_schema.foreign_tables.ForeignTablesViewRepoImpl.selectAll,
            adventureworks.information_schema.parameters.ParametersViewRepoImpl.selectAll,
            adventureworks.information_schema.routine_routine_usage.RoutineRoutineUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.schemata.SchemataViewRepoImpl.selectAll,
            adventureworks.information_schema.foreign_data_wrapper_options.ForeignDataWrapperOptionsViewRepoImpl.selectAll,
            adventureworks.information_schema.data_type_privileges.DataTypePrivilegesViewRepoImpl.selectAll,
            adventureworks.information_schema.sql_sizing.SqlSizingRepoImpl.selectAll,
            adventureworks.information_schema.constraint_table_usage.ConstraintTableUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.check_constraints.CheckConstraintsViewRepoImpl.selectAll,
            adventureworks.information_schema.role_udt_grants.RoleUdtGrantsViewRepoImpl.selectAll,
            adventureworks.information_schema.columns.ColumnsViewRepoImpl.selectAll,
            adventureworks.information_schema.routine_privileges.RoutinePrivilegesViewRepoImpl.selectAll,
            adventureworks.information_schema.role_routine_grants.RoleRoutineGrantsViewRepoImpl.selectAll,
            adventureworks.information_schema.collations.CollationsViewRepoImpl.selectAll,
            adventureworks.information_schema.column_privileges.ColumnPrivilegesViewRepoImpl.selectAll,
            adventureworks.information_schema.sql_implementation_info.SqlImplementationInfoRepoImpl.selectAll,
            adventureworks.information_schema.foreign_data_wrappers.ForeignDataWrappersViewRepoImpl.selectAll,
            adventureworks.information_schema.column_udt_usage.ColumnUdtUsageViewRepoImpl.selectAll,
            adventureworks.information_schema.views.ViewsViewRepoImpl.selectAll,
            adventureworks.information_schema.foreign_server_options.ForeignServerOptionsViewRepoImpl.selectAll,
            adventureworks.information_schema.udt_privileges.UdtPrivilegesViewRepoImpl.selectAll,
            adventureworks.information_schema.role_column_grants.RoleColumnGrantsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_bgwriter.PgStatBgwriterViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_user_tables.PgStatUserTablesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_slru.PgStatSlruViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_sequence.PgSequenceRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_timezone_abbrevs.PgTimezoneAbbrevsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statio_sys_tables.PgStatioSysTablesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_seclabels.PgSeclabelsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_progress_copy.PgStatProgressCopyViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_file_settings.PgFileSettingsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_archiver.PgStatArchiverViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_subscription.PgStatSubscriptionViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_replication_slots.PgReplicationSlotsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_wal_receiver.PgStatWalReceiverViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_prepared_statements.PgPreparedStatementsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_opfamily.PgOpfamilyRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_foreign_server.PgForeignServerRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_progress_analyze.PgStatProgressAnalyzeViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_user_indexes.PgStatUserIndexesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_amop.PgAmopRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_range.PgRangeRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_shadow.PgShadowViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_operator.PgOperatorRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_database_conflicts.PgStatDatabaseConflictsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_indexes.PgIndexesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_foreign_table.PgForeignTableRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statio_sys_indexes.PgStatioSysIndexesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statio_all_indexes.PgStatioAllIndexesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_activity.PgStatActivityViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_all_tables.PgStatAllTablesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_views.PgViewsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_authid.PgAuthidRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_backend_memory_contexts.PgBackendMemoryContextsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_progress_basebackup.PgStatProgressBasebackupViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_cursors.PgCursorsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_event_trigger.PgEventTriggerRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_available_extensions.PgAvailableExtensionsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_attribute.PgAttributeRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_extension.PgExtensionRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stats.PgStatsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statio_sys_sequences.PgStatioSysSequencesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_publication_rel.PgPublicationRelRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_publication.PgPublicationRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_replication.PgStatReplicationViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stats_ext.PgStatsExtViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_type.PgTypeRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_config.PgConfigViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_auth_members.PgAuthMembersRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_opclass.PgOpclassRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_user_mappings.PgUserMappingsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_aggregate.PgAggregateRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_tables.PgTablesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statio_all_sequences.PgStatioAllSequencesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statio_user_sequences.PgStatioUserSequencesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_database.PgStatDatabaseViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_ts_template.PgTsTemplateRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_xact_all_tables.PgStatXactAllTablesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_db_role_setting.PgDbRoleSettingRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statistic_ext.PgStatisticExtRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_subscription.PgSubscriptionRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_index.PgIndexRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_attrdef.PgAttrdefRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_shseclabel.PgShseclabelRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_class.PgClassRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_rules.PgRulesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_replication_slots.PgStatReplicationSlotsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_namespace.PgNamespaceRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_progress_vacuum.PgStatProgressVacuumViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_tablespace.PgTablespaceRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_shdescription.PgShdescriptionRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_policy.PgPolicyRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_enum.PgEnumRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_inherits.PgInheritsRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statio_user_tables.PgStatioUserTablesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_shdepend.PgShdependRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statistic_ext_data.PgStatisticExtDataRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statio_all_tables.PgStatioAllTablesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_group.PgGroupViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_prepared_xacts.PgPreparedXactsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_timezone_names.PgTimezoneNamesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statio_user_indexes.PgStatioUserIndexesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_largeobject_metadata.PgLargeobjectMetadataRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_depend.PgDependRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_ts_config.PgTsConfigRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_cast.PgCastRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_seclabel.PgSeclabelRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_wal.PgStatWalViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_foreign_data_wrapper.PgForeignDataWrapperRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_user_mapping.PgUserMappingRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_conversion.PgConversionRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_am.PgAmRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_all_indexes.PgStatAllIndexesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_roles.PgRolesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stats_ext_exprs.PgStatsExtExprsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_partitioned_table.PgPartitionedTableRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_policies.PgPoliciesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_ts_config_map.PgTsConfigMapRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_sys_tables.PgStatSysTablesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_init_privs.PgInitPrivsRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_progress_create_index.PgStatProgressCreateIndexViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_sys_indexes.PgStatSysIndexesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_sequences.PgSequencesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_user.PgUserViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_replication_origin.PgReplicationOriginRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_subscription_rel.PgSubscriptionRelRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_matviews.PgMatviewsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_ssl.PgStatSslViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_progress_cluster.PgStatProgressClusterViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_language.PgLanguageRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_locks.PgLocksViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_rewrite.PgRewriteRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_largeobject.PgLargeobjectRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_user_functions.PgStatUserFunctionsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_available_extension_versions.PgAvailableExtensionVersionsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_xact_user_functions.PgStatXactUserFunctionsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_publication_tables.PgPublicationTablesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_shmem_allocations.PgShmemAllocationsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_statistic.PgStatisticRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_xact_user_tables.PgStatXactUserTablesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_collation.PgCollationRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_database.PgDatabaseRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_settings.PgSettingsViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_ts_parser.PgTsParserRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_proc.PgProcRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_hba_file_rules.PgHbaFileRulesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_gssapi.PgStatGssapiViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_default_acl.PgDefaultAclRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_ts_dict.PgTsDictRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_replication_origin_status.PgReplicationOriginStatusViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_stat_xact_sys_tables.PgStatXactSysTablesViewRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_transform.PgTransformRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_description.PgDescriptionRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_amproc.PgAmprocRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_constraint.PgConstraintRepoImpl.selectAll,
            adventureworks.pg_catalog.pg_trigger.PgTriggerRepoImpl.selectAll
          )
        )
        .flatMap(_.take(1))
        .foreach(v => ZIO.succeed(println(v)))
    )
  }
}
