/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks
package pg_catalog
package pg_partitioned_table

import anorm.SqlStringInterpolation
import java.sql.Connection

object PgPartitionedTableRepoImpl extends PgPartitionedTableRepo {
  override def delete(partrelid: PgPartitionedTableId)(implicit c: Connection): Boolean = {
    SQL"delete from pg_catalog.pg_partitioned_table where partrelid = $partrelid".executeUpdate() > 0
  }
  override def insert(unsaved: PgPartitionedTableRow)(implicit c: Connection): PgPartitionedTableRow = {
    SQL"""insert into pg_catalog.pg_partitioned_table(partrelid, partstrat, partnatts, partdefid, partattrs, partclass, partcollation, partexprs)
          values (${unsaved.partrelid}::oid, ${unsaved.partstrat}::char, ${unsaved.partnatts}::int2, ${unsaved.partdefid}::oid, ${unsaved.partattrs}::int2vector, ${unsaved.partclass}::oidvector, ${unsaved.partcollation}::oidvector, ${unsaved.partexprs}::pg_node_tree)
          returning partrelid, partstrat, partnatts, partdefid, partattrs, partclass, partcollation, partexprs
       """
      .executeInsert(PgPartitionedTableRow.rowParser(1).single)
  
  }
  override def selectAll(implicit c: Connection): List[PgPartitionedTableRow] = {
    SQL"""select partrelid, partstrat, partnatts, partdefid, partattrs, partclass, partcollation, partexprs
          from pg_catalog.pg_partitioned_table
       """.as(PgPartitionedTableRow.rowParser(1).*)
  }
  override def selectById(partrelid: PgPartitionedTableId)(implicit c: Connection): Option[PgPartitionedTableRow] = {
    SQL"""select partrelid, partstrat, partnatts, partdefid, partattrs, partclass, partcollation, partexprs
          from pg_catalog.pg_partitioned_table
          where partrelid = $partrelid
       """.as(PgPartitionedTableRow.rowParser(1).singleOpt)
  }
  override def selectByIds(partrelids: Array[PgPartitionedTableId])(implicit c: Connection): List[PgPartitionedTableRow] = {
    SQL"""select partrelid, partstrat, partnatts, partdefid, partattrs, partclass, partcollation, partexprs
          from pg_catalog.pg_partitioned_table
          where partrelid = ANY($partrelids)
       """.as(PgPartitionedTableRow.rowParser(1).*)
  
  }
  override def update(row: PgPartitionedTableRow)(implicit c: Connection): Boolean = {
    val partrelid = row.partrelid
    SQL"""update pg_catalog.pg_partitioned_table
          set partstrat = ${row.partstrat}::char,
              partnatts = ${row.partnatts}::int2,
              partdefid = ${row.partdefid}::oid,
              partattrs = ${row.partattrs}::int2vector,
              partclass = ${row.partclass}::oidvector,
              partcollation = ${row.partcollation}::oidvector,
              partexprs = ${row.partexprs}::pg_node_tree
          where partrelid = $partrelid
       """.executeUpdate() > 0
  }
  override def upsert(unsaved: PgPartitionedTableRow)(implicit c: Connection): PgPartitionedTableRow = {
    SQL"""insert into pg_catalog.pg_partitioned_table(partrelid, partstrat, partnatts, partdefid, partattrs, partclass, partcollation, partexprs)
          values (
            ${unsaved.partrelid}::oid,
            ${unsaved.partstrat}::char,
            ${unsaved.partnatts}::int2,
            ${unsaved.partdefid}::oid,
            ${unsaved.partattrs}::int2vector,
            ${unsaved.partclass}::oidvector,
            ${unsaved.partcollation}::oidvector,
            ${unsaved.partexprs}::pg_node_tree
          )
          on conflict (partrelid)
          do update set
            partstrat = EXCLUDED.partstrat,
            partnatts = EXCLUDED.partnatts,
            partdefid = EXCLUDED.partdefid,
            partattrs = EXCLUDED.partattrs,
            partclass = EXCLUDED.partclass,
            partcollation = EXCLUDED.partcollation,
            partexprs = EXCLUDED.partexprs
          returning partrelid, partstrat, partnatts, partdefid, partattrs, partclass, partcollation, partexprs
       """
      .executeInsert(PgPartitionedTableRow.rowParser(1).single)
  
  }
}
