/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks
package person_detail

import adventureworks.TypoLocalDateTime
import doobie.free.connection.ConnectionIO
import doobie.syntax.string.toSqlInterpolator
import fs2.Stream

object PersonDetailSqlRepoImpl extends PersonDetailSqlRepo {
  override def apply(businessentityid: /* nullability unknown */ Option[Int],
                     modifiedAfter: /* nullability unknown */ Option[TypoLocalDateTime]): Stream[ConnectionIO, PersonDetailSqlRow] = {
    val sql =
      sql"""SELECT s.businessentityid
                   , p.title
                   , p.firstname
                   , p.middlename
                   , p.namestyle
                   , e.jobtitle
                   , a.addressline1
                   , a.city
                   , a.postalcode
            FROM sales.salesperson s
                     JOIN humanresources.employee e ON e.businessentityid = s.businessentityid
                     JOIN person.person p ON p.businessentityid = s.businessentityid
                     JOIN person.businessentityaddress bea ON bea.businessentityid = s.businessentityid
                     JOIN person.address a ON a.addressid = bea.addressid
            where s.businessentityid = $businessentityid::int4
            and p.modifieddate > $modifiedAfter::timestamp"""
    sql.query(PersonDetailSqlRow.read).stream
    
  }
}
