/**
 * File has been automatically generated by `typo` for internal use.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 *
 * (If you're developing `typo` and want to change it: run `bleep generate-sources`)
 */
package typo
package generated
package custom
package view_find_all

import anorm.RowParser
import anorm.SqlStringInterpolation
import anorm.Success
import java.sql.Connection
import typo.generated.pg_catalog.pg_namespace.PgNamespaceId

object ViewFindAllSqlRepoImpl extends ViewFindAllSqlRepo {
  override def apply()(implicit c: Connection): List[ViewFindAllSqlRow] = {
    val sql =
      SQL"""SELECT nc.oid                                        as table_oid,
                   nc.nspname::information_schema.sql_identifier AS table_schema,
                   c.relname::information_schema.sql_identifier  AS table_name,
                   c.relkind,
                   CASE
                       WHEN pg_has_role(c.relowner, 'USAGE'::text) THEN pg_get_viewdef(c.oid)
                       ELSE NULL::text
                       END::information_schema.character_data    AS view_definition
            FROM pg_namespace nc,
                 pg_class c
            WHERE c.relnamespace = nc.oid
              AND c.relkind in ('m'::"char", 'v'::char)
            order by 1, 2, 3
         """
    sql.as(rowParser.*)
  
  }
  val rowParser: RowParser[ViewFindAllSqlRow] =
    RowParser[ViewFindAllSqlRow] { row =>
      Success(
        ViewFindAllSqlRow(
          tableOid = row[PgNamespaceId]("table_oid"),
          tableSchema = row[/* nullability unknown */ Option[String]]("table_schema"),
          tableName = row[/* nullability unknown */ Option[String]]("table_name"),
          relkind = row[String]("relkind"),
          viewDefinition = row[/* nullability unknown */ Option[String]]("view_definition")
        )
      )
    }
}
